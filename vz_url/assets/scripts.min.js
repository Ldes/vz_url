var vzUrl={regex:new RegExp("^((https?|ftp)://[\\w\\-_]+(\\.[\\w\\-_]+)+|/)([\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\w\\-\\@?^=%!&amp;/~\\+#])?$","gi"),init:function(a){$(".vz_url_field").each(vzUrl.check_field).live("keyup",vzUrl.check_field).live("paste",function(b){setTimeout(function(){vzUrl.check_field.call(b.target);
},0);});},check_field:function(a){$field=$(this);if(vzUrl.timer){clearTimeout(vzUrl.timer);}if($field.val()==="http://"||$field.val()===""){vzUrl.set_status($field,"empty");
return;}else{vzUrl.set_status($field,"checking");}vzUrl.timer=setTimeout(function(){vzUrl.ajax_call($field);},350);},ajax_call:function(b){var a=b.val();
if(!a.match(vzUrl.regex)){vzUrl.set_status(b,"invalid");return;}if(b.hasClass("local")&&a.substr(0,1)!="/"&&a.indexOf(document.domain)==-1){vzUrl.set_status(b,"nonlocal");
return;}$.getJSON(EE.BASE+"&callback=?",{caller:"vz_url",url:a},function(c){if(c.original!=a){return;}if((c.original==c.final_url)&&(c.http_code>=200)&&(c.http_code<400)){vzUrl.set_status(b,"valid");
}else{if(c.original!=c.final_url){vzUrl.set_status(b,"redirect",c);}else{vzUrl.set_status(b,"invalid");}}});},set_status:function(c,a,b){c.removeClass("empty checking invalid valid nonlocal redirect");
c.prev().remove();setTimeout(function(){var d=c.next().empty();switch(a){case"empty":case"checking":case"valid":break;case"invalid":d.html(vzUrl_settings.errorText);
break;case"nonlocal":d.html(vzUrl_settings.nonlocalText);break;case"redirect":if(c.hasClass("show_redirect")){d.html(vzUrl_settings.redirectText+" "+b.final_url);
$("<a/>",{text:vzUrl_settings.redirectUpdate,href:"#","data-final_url":b.final_url,click:function(f){c.val($(this).attr("data-final_url"));vzUrl.ajax_call(c);
return false;}}).appendTo(d);}else{c.removeClass("redirect").addClass("valid");}break;}if((a==="valid"||a==="redirect")&&!c.parent().parent().hasClass("matrix")){c.before('<a href="'+c.val()+'" class="vz_url_visit" target="_blank">'+vzUrl_settings.openText+"</a>");
}c.addClass(a);},200);}};vzUrl.init();