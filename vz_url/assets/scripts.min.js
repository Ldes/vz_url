jQuery(function(b){var a={regex:new RegExp("^((https?|ftp)://[\\w\\-_]+(\\.[\\w\\-_]+)+|/)([\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\w\\-\\@?^=%&amp;/~\\+#])?$","gi"),init:function(c){b(".vz_url_field").each(a.check_field).live("keyup",a.check_field).live("paste",function(d){setTimeout(function(){a.check_field.call(d.target);
},0);});},check_field:function(c){$field=b(this);if(a.timer){clearTimeout(a.timer);}a.set_status($field,"checking");if($field.val()==="http://"||$field.val()===""){a.set_status($field,"empty");
return;}else{$field.removeClass("empty");}a.timer=setTimeout(function(){a.ajax_call($field);},350);},ajax_call:function(d){var c=d.val();if(!c.match(a.regex)){a.set_status(d,"invalid");
return;}if(d.hasClass("local")&&c.substr(0,1)!="/"&&c.indexOf(document.domain)==-1){a.set_status(d,"nonlocal");return;}b.getJSON(EE.BASE+"&callback=?",{caller:"vz_url",url:c},function(e){if(e.original!=c){return;
}if((e.original==e.final_url)&&(e.http_code>=200)&&(e.http_code<400)){a.set_status(d,"valid");}else{if(e.original!=e.final_url){a.set_status(d,"redirect",e);
}else{a.set_status(d,"invalid");}}});},set_status:function(f,d,e){var c=f.next().empty();f.removeClass("empty checking invalid valid nonlocal redirect").addClass(d);
switch(d){case"empty":case"checking":break;case"valid":break;case"invalid":c.html(vzUrl_settings.errorText);break;case"nonlocal":c.html(vzUrl_settings.nonlocalText);
break;case"redirect":if(f.hasClass("show_redirect")){c.html(vzUrl_settings.redirectText+" "+e.final_url);b("<a/>",{text:vzUrl_settings.redirectUpdate,href:"#","data-final_url":e.final_url,click:function(g){f.val(b(this).attr("data-final_url"));
a.ajax_call(f);return false;}}).appendTo(c);}else{f.removeClass("redirect").addClass("valid");}break;}},not_natively_supported:(function(){var c=document.createElement("input");
return !("pattern" in c);})()};a.init();});