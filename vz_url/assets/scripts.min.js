var vzUrl={regex:new RegExp("^((https?|ftp)://[\\w\\-_]+(\\.[\\w\\-_]+)+|/)([\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\w\\-\\@?^=%!&amp;/~\\+#])?$","gi"),init:function(a){$("#publishForm").on("keyup paste",".vz_url_field",function(b){vzUrl.check_field.call(b.target,true);
});$(".vz_url_field").each(vzUrl.check_field);},check_field:function(a){$field=$(this);if(a&&vzUrl.timer){clearTimeout(vzUrl.timer);}if($field.val()==="http://"||$field.val()===""){vzUrl.set_status($field,"empty");
return;}else{vzUrl.set_status($field,"checking");}if(a){vzUrl.timer=setTimeout(function(){vzUrl.validate($field);},a);}else{vzUrl.validate($field);}},validate:function(b){var a=b.val();
if(!a.match(vzUrl.regex)){vzUrl.set_status(b,"invalid");return;}if(b.hasClass("local")&&a.substr(0,1)!="/"&&a.indexOf(document.domain)==-1){vzUrl.set_status(b,"nonlocal");
return;}$.getJSON(EE.BASE+"&callback=?",{caller:"vz_url",url:a},function(c){if(c.original!=a){return;}if((c.original==c.final_url)&&(c.http_code>=200)&&(c.http_code<400)){vzUrl.set_status(b,"valid");
}else{if(c.original!=c.final_url){vzUrl.set_status(b,"redirect",c);}else{vzUrl.set_status(b,"invalid");}}});},set_status:function(d,b,c){d.removeClass("empty checking invalid valid nonlocal redirect");
d.prev().remove();var a=d.next().empty();switch(b){case"empty":case"checking":case"valid":break;case"invalid":a.html(vzUrl_settings.errorText);break;case"nonlocal":a.html(vzUrl_settings.nonlocalText);
break;case"redirect":if(d.hasClass("show_redirect")){a.html(vzUrl_settings.redirectText+" "+c.final_url);$("<a/>",{text:vzUrl_settings.redirectUpdate,href:"#","data-final_url":c.final_url,click:function(f){d.val($(this).attr("data-final_url"));
vzUrl.validate(d);return false;}}).appendTo(a);}else{d.removeClass("redirect").addClass("valid");}break;}d.addClass(b);if((b==="valid"||b==="redirect")&&!d.parent().parent().hasClass("matrix")){d.before('<a href="'+d.val()+'" class="vz_url_visit" target="_blank">'+vzUrl_settings.openText+"</a>");
}}};vzUrl.init();